<!-- ?xml version='1.0' encoding='UTF-8'? -->
<link href="github-css.css" rel="stylesheet"/>
<meta charset="utf-8" content="text/html"/>
<div class="gist">
<style> .gist-file { max-width: 25cm; margin: 0 auto; } </style>
<style class="formula-style">
        svg.gh-md-to-html-formula {
            fill: black;
        }
    </style>
<div class="gist-file"> <!-- This is the class that is responsible for the boxing! -->
<div class="gist-data">
<div class="js-gist-file-update-container js-task-list-container file-box">
<div class="file" id="user-content-article-tempfile">
<div class="Box-body readme blob js-code-block-container p-5 p-xl-6" id="user-content-file-docker-image-pull-md-readme" style="margin-left: 40px; margin-right: 40px; margin-top: 20px; margin-bottom: 20px">
<article class="markdown-body entry-content container-lg" itemprop="text">
<div class="markdown-heading"><h1 class="heading-element">MacPaint Document</h1><a aria-label="Permalink: MacPaint Document" class="anchor" href="#user-content-macpaint-document" id="user-content-macpaint-document" name="user-content-macpaint-document"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>File types:</p>
<ul>
<li>HFS 'PNTG', often with creator 'MPNT'</li>
</ul>
<p>Primary references:</p>
<ul>
<li>Macintosh Technical Note PT 24, "MacPaint Document Format" (revised June 1989),
<a href="http://www.idea2ic.com/File_Formats/macpaint.pdf" rel="nofollow">http://www.idea2ic.com/File_Formats/macpaint.pdf</a>
</li>
<li>Technical Note TN1023, "Understanding PackBits",
<a href="http://web.archive.org/web/20080705155158/http://developer.apple.com/technotes/tn/tn1023.html" rel="nofollow">http://web.archive.org/web/20080705155158/http://developer.apple.com/technotes/tn/tn1023.html</a>
</li>
<li>PackBits wikipedia page: <a href="https://en.wikipedia.org/wiki/PackBits" rel="nofollow">https://en.wikipedia.org/wiki/PackBits</a>
</li>
</ul>
<div class="markdown-heading"><h2 class="heading-element">General</h2><a aria-label="Permalink: General" class="anchor" href="#user-content-general" id="user-content-general" name="user-content-general"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p><a href="https://en.wikipedia.org/wiki/MacPaint" rel="nofollow">MacPaint</a> is a raster graphics editor developed by
Apple Computer for the original Macintosh.  The documents it creates are 576x720 monochrome
bitmaps; at 72dpi, this matches the 8x10 inch area of a standard ImageWriter printer page.  (The
resolution of the original Macintosh was 512x342, so the bitmap was larger than the screen in
both directions.)</p>
<p>To reduce disk space, the bitmap is compressed with a simple run-length encoding algorithm
implemented by the built-in "PackBits" function.</p>
<p>On HFS filesystems, these documents used the file type 'PNTG'.  On other systems, the filename
extension ".pntg" or simply ".mac" were sometimes used.  Images uploaded to online services were
often prefixed with a MacBinary header.  Without one of these, it's very difficult to identify
a MacPaint document as such, except by attempting to fully decode it.</p>
<p>The source code for MacPaint is available from the
<a href="https://computerhistory.org/blog/macpaint-and-quickdraw-source-code/" rel="nofollow">Computer History Museum</a>.</p>
<div class="markdown-heading"><h2 class="heading-element">File Structure</h2><a aria-label="Permalink: File Structure" class="anchor" href="#user-content-file-structure" id="user-content-file-structure" name="user-content-file-structure"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The file format is:</p>
<pre><code>+$000 /  4: big-endian version number (0 or 2)
+$004 /304: for version=2, 38 sets of 8-byte patterns; otherwise junk
+$134 /204: reserved
+$200 /nnn: bitmap data
</code></pre>
<p>Files with version zero use default patterns, so the pattern section should be ignored.</p>
<p>The bitmap data consists of 720 rows, each of which is compressed in isolation with PackBits.
The leftmost pixel corresponds to the high bit in a byte.  A '1' bit indicates a black pixel.</p>
<div class="markdown-heading"><h3 class="heading-element">PackBits</h3><a aria-label="Permalink: PackBits" class="anchor" href="#user-content-packbits" id="user-content-packbits" name="user-content-packbits"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>The PackBits function compressed data using a byte-oriented form of run-length encoding.</p>
<p>The compressed data has a "flag-counter" byte, followed by one or more data bytes, and then
the next flag-counter byte.  The flag-counter byte is taken as a signed value:</p>
<ul>
<li>-128: not generated by ROM, should be ignored except for application-specific uses</li>
<li>N &lt; 0: repeat the next byte (1 - N) times</li>
<li>N &gt;= 0: copy the next (1 + N) bytes verbatim</li>
</ul>
</article>
</div>
</div>
</div>
</div>
<div class="gist-meta">
<p><a href="../doc-index.html">Return to documentation index</a> | <a href="https://github.com/fadden/CiderPress2/blob/main/FileConv/Gfx/MacPaint-notes.md">View in source tree</a></p>
</div>
</div>
</div>
